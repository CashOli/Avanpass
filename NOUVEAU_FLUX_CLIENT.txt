â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… NOUVEAU FLUX CLIENT SÃ‰PARÃ‰ (INSCRIPTION / ACTIVATION)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ PROBLÃˆMES RÃ‰SOLUS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âŒ "Aucune carte active pour voir ma carte"
âŒ "Erreur de l'activation"

âœ… Flux sÃ©parÃ© comme pour PC
âœ… Inscription SANS code
âœ… Activation AVEC code (sÃ©parÃ©e)


ğŸ¬ NOUVEAU FLUX CLIENT
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Ã‰TAPE 1 : Ã‰CRAN DE CHOIX     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [ ğŸ“ S'inscrire ]             â”‚
â”‚  [ ğŸ”‘ Se connecter ]           â”‚
â”‚  [ ğŸ« Activer ma carte ]       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

         â†“

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Ã‰TAPE 2A : INSCRIPTION       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Email *                       â”‚
â”‚  Mot de passe *                â”‚
â”‚  PrÃ©nom *                      â”‚
â”‚  Nom *                         â”‚
â”‚  TÃ©lÃ©phone                     â”‚
â”‚                                â”‚
â”‚  â†’ Statut : INACTIVE           â”‚
â”‚  â†’ Pas de QR code              â”‚
â”‚  â†’ Carte NON activÃ©e           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

         â†“

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Ã‰TAPE 2B : ACTIVATION        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Email (identifiants)          â”‚
â”‚  Mot de passe                  â”‚
â”‚  Code d'activation             â”‚
â”‚                                â”‚
â”‚  â†’ Statut : ACTIVE             â”‚
â”‚  â†’ QR code gÃ©nÃ©rÃ©              â”‚
â”‚  â†’ Dates calculÃ©es (+1 an)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

         â†“

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Ã‰TAPE 2C : CONNEXION         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Email                         â”‚
â”‚  Mot de passe                  â”‚
â”‚                                â”‚
â”‚  â†’ VÃ©rification statut         â”‚
â”‚  â†’ Affichage carte si active   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


ğŸ“ DÃ‰TAILS DES Ã‰TAPES
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

1ï¸âƒ£ INSCRIPTION (register)
   âœ… Email unique vÃ©rifiÃ©
   âœ… Mot de passe hashÃ© (bcrypt)
   âœ… PrÃ©nom, Nom, TÃ©lÃ©phone
   âŒ PAS de code d'activation
   â†’ Client crÃ©Ã© avec statut_carte = 'inactive'
   â†’ qr_token_client = '' (vide)
   â†’ date_activation = null
   â†’ date_expiration = null

2ï¸âƒ£ ACTIVATION (activateCard)
   âœ… Email + mot de passe (identification)
   âœ… Code d'activation vÃ©rifiÃ©
   âœ… QR token gÃ©nÃ©rÃ©
   âœ… Dates calculÃ©es (+1 an)
   â†’ Mise Ã  jour client :
      â€¢ statut_carte = 'active'
      â€¢ qr_token_client = UUID unique
      â€¢ date_activation = aujourd'hui
      â€¢ date_expiration = +1 an
   â†’ Code marquÃ© comme utilisÃ©
   â†’ Connexion automatique

3ï¸âƒ£ CONNEXION (login)
   âœ… Email + mot de passe
   âœ… VÃ©rification statut carte :
      â€¢ inactive â†’ Redirection activation
      â€¢ suspendue â†’ Message erreur
      â€¢ expiree â†’ Message erreur
      â€¢ active â†’ Affichage carte âœ…


ğŸ¨ INTERFACES
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Ã‰CRAN CHOIX (client-choice)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† Espace Client               â”‚
â”‚                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ğŸ“ S'inscrire           â”‚  â”‚
â”‚  â”‚  CrÃ©er mon compte client â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ğŸ”‘ Se connecter         â”‚  â”‚
â”‚  â”‚  J'ai dÃ©jÃ  un compte     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  ğŸ« Activer ma carte     â”‚  â”‚
â”‚  â”‚  J'ai un code activation â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


Ã‰CRAN INSCRIPTION (client-registration)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† CrÃ©er mon compte            â”‚
â”‚                                â”‚
â”‚  Email *                       â”‚
â”‚  [votre@email.com_________]    â”‚
â”‚                                â”‚
â”‚  Mot de passe * (min 6)        â”‚
â”‚  [â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢_______________]     â”‚
â”‚                                â”‚
â”‚  PrÃ©nom *                      â”‚
â”‚  [Jean___________________]     â”‚
â”‚                                â”‚
â”‚  Nom *                         â”‚
â”‚  [Dupont_________________]     â”‚
â”‚                                â”‚
â”‚  TÃ©lÃ©phone                     â”‚
â”‚  [06 12 34 56 78_________]     â”‚
â”‚                                â”‚
â”‚  [ CrÃ©er mon compte ]          â”‚
â”‚                                â”‚
â”‚  â„¹ï¸ AprÃ¨s inscription, vous    â”‚
â”‚  devrez activer votre carte    â”‚
â”‚  avec un code d'activation     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


Ã‰CRAN ACTIVATION (client-activation)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† Activer ma carte            â”‚
â”‚                                â”‚
â”‚  ğŸ«                            â”‚
â”‚                                â”‚
â”‚  Vous devez Ãªtre inscrit et    â”‚
â”‚  connectÃ© pour activer votre   â”‚
â”‚  carte.                        â”‚
â”‚                                â”‚
â”‚  Email                         â”‚
â”‚  [votre@email.com_________]    â”‚
â”‚                                â”‚
â”‚  Mot de passe                  â”‚
â”‚  [â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢_______________]     â”‚
â”‚                                â”‚
â”‚  Code d'activation             â”‚
â”‚  [CODE-ACTIVATION________]     â”‚
â”‚                                â”‚
â”‚  [ Activer ma carte ]          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


Ã‰CRAN CONNEXION (client-login)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† Connexion                   â”‚
â”‚                                â”‚
â”‚  ğŸ‘¤                            â”‚
â”‚                                â”‚
â”‚  Email                         â”‚
â”‚  [votre@email.com_________]    â”‚
â”‚                                â”‚
â”‚  Mot de passe                  â”‚
â”‚  [â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢_______________]     â”‚
â”‚                                â”‚
â”‚  [ Se connecter ]              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


ğŸ”§ CODE TECHNIQUE
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

INSCRIPTION
```javascript
const clientData = {
    email: email,
    password_hash: passwordHash,
    prenom: prenom,
    nom: nom,
    telephone: telephone,
    statut_carte: 'inactive',    // â† INACTIVE
    date_activation: null,        // â† NULL
    date_expiration: null,        // â† NULL
    qr_token_client: ''           // â† VIDE
};
```

ACTIVATION
```javascript
// GÃ©nÃ©rer QR et dates
const qrToken = Utils.generateQRToken();
const dateActivation = new Date();
const dateExpiration = new Date(dateActivation);
dateExpiration.setFullYear(dateExpiration.getFullYear() + 1); // +1 an

// Mettre Ã  jour le client
await API.patch('clients', client.id, {
    statut_carte: 'active',
    date_activation: dateActivation.toISOString(),
    date_expiration: dateExpiration.toISOString(),
    qr_token_client: qrToken
});
```

CONNEXION
```javascript
// VÃ©rifier statut
if (client.statut_carte === 'inactive') {
    // â†’ Redirection vers activation
    this.showActivation();
} else if (client.statut_carte === 'active') {
    // â†’ Affichage carte
    this.showCard();
}
```


ğŸ“‚ FICHIERS MODIFIÃ‰S
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âœ… index.html
   â€¢ Ajout #client-choice (3 boutons)
   â€¢ Ajout #client-activation
   â€¢ Modification structure

âœ… js/client.js (complÃ¨tement rÃ©Ã©crit - 31 Ko)
   â€¢ showChoice() â†’ Ã‰cran 3 boutons
   â€¢ showRegistration() â†’ Formulaire inscription
   â€¢ register() â†’ Inscription sans code
   â€¢ showActivation() â†’ Formulaire activation
   â€¢ activateCard() â†’ Activation avec code
   â€¢ login() â†’ VÃ©rification statut carte
   â€¢ Dates : "Valide du X au Y"

âœ… CHANGELOG.md
   â€¢ Version 1.6.0


ğŸ§ª POUR TESTER
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

âš ï¸ VIDER LE CACHE OBLIGATOIRE !

1. Ctrl + Shift + R (plusieurs fois)
2. Ou vider cache Chrome complÃ¨tement
3. Fermer et rouvrir Chrome

TEST COMPLET :

1ï¸âƒ£ S'INSCRIRE
   â€¢ Aller sur "Client"
   â€¢ Cliquer "S'inscrire"
   â€¢ Email : test@nouveau.fr
   â€¢ Mot de passe : test123
   â€¢ PrÃ©nom/Nom : Test Nouveau
   â€¢ CrÃ©er mon compte
   â€¢ â†’ Message : "Compte crÃ©Ã©"
   â€¢ â†’ Redirection vers activation

2ï¸âƒ£ ACTIVER
   â€¢ Email : test@nouveau.fr
   â€¢ Mot de passe : test123
   â€¢ Code : (code valide)
   â€¢ Activer ma carte
   â€¢ â†’ Message : "Carte activÃ©e"
   â€¢ â†’ Affichage carte avec QR

3ï¸âƒ£ SE DÃ‰CONNECTER ET RECONNECTER
   â€¢ Cliquer "Logout"
   â€¢ Aller sur "Client" â†’ "Se connecter"
   â€¢ Email + mot de passe
   â€¢ â†’ Carte affichÃ©e directement


â“ FAQ
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Q : Puis-je me connecter avant d'activer ?
A : âœ… Oui, mais un message vous demandera d'activer d'abord

Q : Le code d'activation est-il obligatoire ?
A : âœ… Oui, pour activer la carte (pas pour s'inscrire)

Q : Combien de codes d'activation faut-il ?
A : 1 code = 1 activation (code consommÃ©)

Q : Puis-je rÃ©activer une carte expirÃ©e ?
A : âš ï¸ Pas encore implÃ©mentÃ© (Ã  venir)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸš€ VIDEZ LE CACHE ET TESTEZ LE NOUVEAU FLUX ! ğŸ’ª
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Version : AvanPass 1.6.0
Date : 15 dÃ©cembre 2024
Statut : âœ… Flux sÃ©parÃ© implÃ©mentÃ©
